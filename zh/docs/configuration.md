# Configuration

You can adjust the setting when initializing Shieldon instance, or using `setProperty` or `setProperties` API later.

*Initializing*
```php

$config = [
    'time_unit_quota' => [
        ['s' => 2, 'm' => 10, 'h' => 30, 'd' => 60]
    ]
];

$kernel = new \Shieldon\Shieldon($config);
```

*setProperty*
```php
$kernel->setProperty('time_unit_quota', [
    's' => 2, 'm' => 10, 'h' => 30, 'd' => 60
]);
```

*setProperties*
```php

$config = [
    'time_unit_quota' => [
        ['s' => 2, 'm' => 10, 'h' => 30, 'd' => 60]
    ]
];

$kernel->setProperties($config);
```
## Default

| key | type | value |
| --- | --- | --- |
| time_unit_quota | array |  `['s' => 2, 'm' => 10, 'h' => 30, 'd' => 60]` |
| time_reset_limit | integer | 3600 |
| interval_check_referer | integer | 5 |
| interval_check_session | integer | 30 |
| limit_unusual_behavior | array | `['cookie' => 5, 'session' => 5, 'referer' => 10]` |
| cookie_name | string | ssjd |
| cookie_domain | string | " |


### time_unit_quota

Setting the limits and quotas for your vistors on your website.

You may check out your Google Analytics to find out how many page views per user is normal condition, then think about what is considered to **bad behavior** on your website.

- array

| key | value | description |
| --- | --- | --- |
| s | integer | Page views per **vistor** per **second** |
| m | integer | Page views per **vistor** per **minute** |
| h | integer | Page views per **vistor** per **hour** |
| d | integer | Page views per **vistor** per **day** |

#### Tips

- If you just want to limit an user to view `100 pages` a day, just set `s`, `m`, `h` to a very high number, and set `d` to `100`.

- To remember, when users reached the limit will just be banned temporaily, they can get unbanned by solving Captcha, so, do not set the values too loose, overwise it is no sense to use this library.

### time_reset_limit

Reset the filiters flagged number after how many seconds that `time_reset_limit` is set.

### interval_check_referer

When an user first time visit to your website by entering URL on browser, the `HTTP_REFERER` is empty. After `interval_check_referer` seconds, Shieldon will start checking `HTTP_REFERER`.

*You can ignore this value.*

### interval_check_session

When an user first time visit to your website, after `interval_check_session` seconds, Shieldon will start checking `SESSION` cookie.

### limit_unusual_behavior

Setting the limits and quotas of being flagged as unusual behavior for your vistors on your website.

- array

| key | value | description |
| --- | --- | --- |
| cookie | integer | Cookie generated by JavaScript. |
| session | integer | PHP Session |
| referer | integer | HTTP_REFERER |

### Others

You can checkout the function `get_default_properties()` in `Shieldon/Firewall/Helpers` class if I don't mention them.
```php
/**
 * The default settings of Shieldon core.
 *
 * @return array
 */
function get_default_properties(): array
{
    return [

        'time_unit_quota' => [
            's' => 2,
            'm' => 10,
            'h' => 30,
            'd' => 60
        ],

        'time_reset_limit'       => 3600,
        'interval_check_referer' => 5,
        'interval_check_session' => 5,
        'limit_unusual_behavior' => [
            'cookie'  => 5,
            'session' => 5,
            'referer' => 10
        ],

        'cookie_name'         => 'ssjd',
        'cookie_domain'       => '',
        'cookie_value'        => '1',
        'display_online_info' => true,
        'display_user_info'   => false,
        'display_http_code'   => false,
        'display_reason_code' => false,
        'display_reason_text' => false,

        /**
         * If you set this option enabled, Shieldon will record every CAPTCHA fails 
         * in a row, once that user have reached the limitation number, Shieldon will
         * put it as a blocked IP in rule table, until the new data cycle begins.
         * 
         * Once that user have been blocked, they are still access the warning page, 
         * it means that they are not humain for sure, so let's throw them into the 
         * system firewall and say goodbye to them forever.
         */
        'deny_attempt_enable' => [
            'data_circle'     => false,
            'system_firewall' => false,
        ],

        'deny_attempt_notify' => [
            'data_circle'     => false,
            'system_firewall' => false,
        ],

        'deny_attempt_buffer' => [
            'data_circle'     => 10,
            'system_firewall' => 10,
        ],

        /**
         * To prevent dropping social platform robots into iptables firewall, such 
         * as Facebook, Line and others who scrape snapshots from your web pages, 
         * you should adjust the values below to fit your needs. (unit: second)
         */
        'record_attempt_detection_period' => 5, // 5 seconds.

        // Reset the counter after n second.
        'reset_attempt_counter' => 1800, // 30 minutes.

        // System-layer firewall, ip6table service watches this folder to 
        // receive command created by Shieldon Firewall.
        'iptables_watching_folder' => '/tmp/',
    ];
}
```


